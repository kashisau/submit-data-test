# Submit data test
## Heroku-hosted Express.js App

This is a simple proof-of-concept for exposing a HTTP POST API for form data submission using Express.js hosted on Heroku.

### Purpose

In order to prevent direct and unchecked access to the HTTP method `POST /submit-data`, this minutre REST API provides two methods, where a CSRF token **must** be generated by the client and supplied along with any submission attempt.

### CSRF token generation (`POST /csrf-token`)

A (cryptographically) random string is generated by the RESTful HTTP method `POST /csrf-token` method, which sets a cookie using the HTTPOnly flag (preventing access from JavaScript). In a more complete system this token would be signed by some private key for verification, or stored in a database for later reference.

The main purpose of this step is to prevent the data submission method from being spammed, creating 1..n entries in the database, each with varying data.

There are some ancillary uses for introducing this inital step. During the request of a CSRF token the client will supply some identifying information, such as IP address, user-agent, etc. These may be used to deny future CSRF issuance for clients that attempt to abuse the subsequent data submission method.

### Data submission (`POST /submit-data`)

Once the client has a CSRF token, the HTTP method `POST /submit-data` may be used to send application data to the server. The `submit-data` router checks for the existence of a CSRF token and issues a `403: Forbidden` if it is not present.

For the purposes of this proof-concept, this is adaquate however a production system will either attempt to validate the signature of the CSRF or match it to an entry in the database. A complete system should also check for blacklisted IPs, user-agents, etc. as well as issue a warning for CSRF tokens that have already been used to make a submission.